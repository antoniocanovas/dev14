<odoo>

        <record id="crm_activity_done_data_in_mail_message" model="base.automation">
            <field name="name">=> Creation Mail Message activity done data</field>
            <field name="model_id" ref="model_mail_message"/>
            <field name="state">code</field>
            <field name="code">
name, stage_name = "", ""
model_id = env['ir.model'].search([('model', '=', record.model)])
item_id = env[record.model].search([('id', '=', record.res_id)])

if (model_id.name): name = model_id.name
if (item_id.stage_id.id): stage_name = item_id.stage_id.name
stage_id = env['mail.message.stage'].search([('name','=',stage_name)])
if not stage_id.id: stage_id = env['mail.message.stage'].create({'name':stage_name})

line = record.body.split("\n")[2]
line = line.split("<span>")[1]
line = line.split("</span>")[0]

record.write({'name':name, 'stage_id':stage_id.id, 'activity_type':line})

            </field>
            <field name="trigger">on_create</field>
            <field name="filter_pre_domain"></field>
            <field name="filter_domain"></field>
            <field name="active" eval="True"/>
    </record>

</odoo>
